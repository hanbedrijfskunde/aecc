<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Mode Content Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .debug-section { background: white; margin: 10px 0; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; border: none; border-radius: 4px; background: #007bff; color: white; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .test-element { background: #e9ecef; padding: 8px; margin: 5px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üîç Mode Content Debug Test</h1>
    
    <div class="debug-section">
        <h2>1. Content Loading Test</h2>
        <button onclick="testContentLoading()">Test Content Loading</button>
        <div id="content-test-results"></div>
    </div>
    
    <div class="debug-section">
        <h2>2. Mode Content Structure</h2>
        <button onclick="testModeStructure()">Check Mode Structure</button>
        <div id="structure-test-results"></div>
    </div>
    
    <div class="debug-section">
        <h2>3. Live Mode Testing</h2>
        <div>
            <button onclick="testMode('traditioneel')" style="background: #28a745;">Test Traditioneel</button>
            <button onclick="testMode('ondersteund')" style="background: #ffc107; color: black;">Test Ondersteund</button>
            <button onclick="testMode('geintegreerd')" style="background: #dc3545;">Test Ge√Øntegreerd</button>
        </div>
        <div id="mode-test-results"></div>
        
        <!-- Test elements -->
        <div style="margin-top: 20px;">
            <h4>Test Elements:</h4>
            <div class="test-element">Tab Title: <span data-mode-text="roleTabTitle">Default Tab Title</span></div>
            <div class="test-element">Monday Step: <span data-mode-text="mondayStepTitle">Default Monday</span></div>
            <div class="test-element">Quick Link: <span data-mode-text="quickLinkAnalyse">Default Quick Link</span></div>
            <div class="test-element">Work Time: <span data-mode-text="workProcessTime">Default Time</span></div>
        </div>
    </div>
    
    <div class="debug-section">
        <h2>4. Console Logs</h2>
        <button onclick="clearLogs()">Clear Logs</button>
        <div id="console-logs" style="max-height: 300px; overflow-y: auto; background: #000; color: #0f0; padding: 10px; font-family: monospace;"></div>
    </div>

    <script>
        // Capture console logs
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        const logs = [];
        
        function addLog(type, message) {
            logs.push({type, message, time: new Date().toLocaleTimeString()});
            updateLogDisplay();
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog('log', args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addLog('warn', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog('error', args.join(' '));
        };
        
        function updateLogDisplay() {
            const logDiv = document.getElementById('console-logs');
            logDiv.innerHTML = logs.slice(-20).map(log => 
                `<div style="color: ${log.type === 'error' ? '#f00' : log.type === 'warn' ? '#ff0' : '#0f0'}">
                    [${log.time}] ${log.type.toUpperCase()}: ${log.message}
                </div>`
            ).join('');
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function clearLogs() {
            logs.length = 0;
            updateLogDisplay();
        }
        
        // Test functions
        async function testContentLoading() {
            const resultDiv = document.getElementById('content-test-results');
            resultDiv.innerHTML = '<p>Testing content loading...</p>';
            
            try {
                // Test window.contentData
                if (window.contentData) {
                    resultDiv.innerHTML += '<div class="success">‚úÖ window.contentData is available</div>';
                    
                    if (window.contentData.modeContent) {
                        resultDiv.innerHTML += '<div class="success">‚úÖ window.contentData.modeContent exists</div>';
                        resultDiv.innerHTML += `<div>Available modes: ${Object.keys(window.contentData.modeContent).join(', ')}</div>`;
                    } else {
                        resultDiv.innerHTML += '<div class="error">‚ùå window.contentData.modeContent is missing</div>';
                    }
                } else {
                    resultDiv.innerHTML += '<div class="error">‚ùå window.contentData is not available</div>';
                    
                    // Try direct fetch
                    const response = await fetch('content.json');
                    const data = await response.json();
                    
                    if (data.modeContent) {
                        resultDiv.innerHTML += '<div class="warning">‚ö†Ô∏è  Direct fetch works, but window.contentData is not set</div>';
                    }
                }
            } catch (error) {
                resultDiv.innerHTML += `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        async function testModeStructure() {
            const resultDiv = document.getElementById('structure-test-results');
            
            try {
                const response = await fetch('content.json');
                const data = await response.json();
                
                if (data.modeContent) {
                    const structure = {};
                    Object.keys(data.modeContent).forEach(mode => {
                        structure[mode] = Object.keys(data.modeContent[mode]);
                    });
                    
                    resultDiv.innerHTML = `<pre>${JSON.stringify(structure, null, 2)}</pre>`;
                } else {
                    resultDiv.innerHTML = '<div class="error">‚ùå No modeContent found</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        async function testMode(mode) {
            const resultDiv = document.getElementById('mode-test-results');
            resultDiv.innerHTML = `<p>Testing mode: ${mode}...</p>`;
            
            try {
                // Simulate the loadModeContent function
                let modeContent;
                
                if (window.contentData && window.contentData.modeContent) {
                    modeContent = window.contentData.modeContent;
                } else {
                    const response = await fetch('content.json');
                    const data = await response.json();
                    modeContent = data.modeContent;
                }
                
                const selectedModeContent = modeContent[mode];
                
                if (!selectedModeContent) {
                    resultDiv.innerHTML += `<div class="error">‚ùå No content found for mode: ${mode}</div>`;
                    return;
                }
                
                // Update test elements
                document.querySelectorAll('[data-mode-text]').forEach(element => {
                    const contentKey = element.dataset.modeText;
                    if (selectedModeContent[contentKey]) {
                        element.textContent = selectedModeContent[contentKey];
                    }
                });
                
                resultDiv.innerHTML += `<div class="success">‚úÖ Mode ${mode} applied successfully</div>`;
                resultDiv.innerHTML += `<div>Found ${Object.keys(selectedModeContent).length} content keys</div>`;
                
            } catch (error) {
                resultDiv.innerHTML += `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Debug page loaded');
            setTimeout(() => {
                testContentLoading();
            }, 500);
        });
    </script>
</body>
</html>