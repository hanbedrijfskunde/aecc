<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal Test - AEC Website</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #2C3E50;
            border-bottom: 3px solid #8FD14F;
            padding-bottom: 10px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #ddd;
            border-radius: 4px;
        }
        .test-item.pass {
            border-left-color: #8FD14F;
            background: #f0f9f0;
        }
        .test-item.fail {
            border-left-color: #E63946;
            background: #fef0f0;
        }
        .test-item.warning {
            border-left-color: #ffc107;
            background: #fffef0;
        }
        .status {
            font-weight: bold;
            margin-right: 10px;
        }
        .pass .status { color: #8FD14F; }
        .fail .status { color: #E63946; }
        .warning .status { color: #ffc107; }
        button {
            background: #8FD14F;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #7AB83F;
        }
        .iframe-container {
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
            background: white;
        }
        iframe {
            width: 100%;
            height: 800px;
            border: none;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .test-results {
            margin-top: 20px;
        }
        #testResults {
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üß™ Student Portal Test Suite - AEC Website</h1>
    
    <div class="test-section">
        <h2>Test Controls</h2>
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="testInteractivity()">Test Interactivity</button>
        <button onclick="testResponsive('mobile')">Test Mobile (375px)</button>
        <button onclick="testResponsive('tablet')">Test Tablet (768px)</button>
        <button onclick="testResponsive('desktop')">Test Desktop (1280px)</button>
        <button onclick="exportResults()">Export Results</button>
    </div>

    <div class="test-section">
        <h2>Automated Tests</h2>
        <div id="automatedTests">
            <div class="test-item" id="test-structure">
                <span class="status">‚è≥</span>
                <strong>Page Structure:</strong> Checking HTML elements...
            </div>
            <div class="test-item" id="test-triangle">
                <span class="status">‚è≥</span>
                <strong>Triangle Conflict:</strong> Verifying SVG visualization...
            </div>
            <div class="test-item" id="test-weeks">
                <span class="status">‚è≥</span>
                <strong>Week Navigator:</strong> Checking 7 week cards...
            </div>
            <div class="test-item" id="test-roles">
                <span class="status">‚è≥</span>
                <strong>Role Cards:</strong> Verifying CEO, CFO, COO, CIO...
            </div>
            <div class="test-item" id="test-tabs">
                <span class="status">‚è≥</span>
                <strong>WAAROM/HOE/WAT:</strong> Testing tab functionality...
            </div>
            <div class="test-item" id="test-prompts">
                <span class="status">‚è≥</span>
                <strong>AI Prompts:</strong> Checking copy functionality...
            </div>
            <div class="test-item" id="test-timeline">
                <span class="status">‚è≥</span>
                <strong>Project Timeline:</strong> Verifying continuity display...
            </div>
            <div class="test-item" id="test-countdown">
                <span class="status">‚è≥</span>
                <strong>Countdown Timer:</strong> Checking timer function...
            </div>
            <div class="test-item" id="test-resources">
                <span class="status">‚è≥</span>
                <strong>Resources Section:</strong> Verifying download templates...
            </div>
            <div class="test-item" id="test-feedback">
                <span class="status">‚è≥</span>
                <strong>Feedback Flow:</strong> Checking SVG diagram...
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>Visual Preview</h2>
        <div class="iframe-container">
            <iframe id="previewFrame" src="../studenten.html"></iframe>
        </div>
    </div>

    <div class="test-section">
        <h2>Test Results</h2>
        <div class="test-results">
            <pre id="testResults">Test results will appear here...</pre>
        </div>
    </div>

    <script>
        let testResults = {
            timestamp: new Date().toISOString(),
            tests: {},
            summary: {
                total: 0,
                passed: 0,
                failed: 0,
                warnings: 0
            }
        };

        function updateTestItem(id, status, message) {
            const item = document.getElementById(id);
            if (!item) return;
            
            item.className = 'test-item ' + status;
            const statusIcon = status === 'pass' ? '‚úÖ' : status === 'fail' ? '‚ùå' : '‚ö†Ô∏è';
            item.querySelector('.status').textContent = statusIcon;
            
            if (message) {
                item.innerHTML += '<div style="margin-top: 10px; font-size: 0.9em; color: #666;">' + message + '</div>';
            }
            
            // Update results
            testResults.tests[id] = { status, message };
            testResults.summary.total++;
            if (status === 'pass') testResults.summary.passed++;
            else if (status === 'fail') testResults.summary.failed++;
            else testResults.summary.warnings++;
        }

        async function runAllTests() {
            console.log('Starting student portal tests...');
            testResults = {
                timestamp: new Date().toISOString(),
                tests: {},
                summary: { total: 0, passed: 0, failed: 0, warnings: 0 }
            };
            
            // Reset all test items
            document.querySelectorAll('.test-item').forEach(item => {
                item.className = 'test-item';
                item.querySelector('.status').textContent = '‚è≥';
            });
            
            try {
                const frame = document.getElementById('previewFrame');
                const frameDoc = frame.contentDocument || frame.contentWindow.document;
                
                // Test 1: Page Structure
                const header = frameDoc.querySelector('.site-header');
                const mainContent = frameDoc.querySelector('.main-content');
                const footer = frameDoc.querySelector('.site-footer');
                const backLink = frameDoc.querySelector('.back-link');
                
                if (header && mainContent && footer && backLink) {
                    updateTestItem('test-structure', 'pass', 'All main structural elements found');
                } else {
                    updateTestItem('test-structure', 'fail', 'Missing structural elements');
                }
                
                // Test 2: Triangle Conflict Visualization
                const triangleSvg = frameDoc.querySelector('.triangle-svg');
                const triangleCircles = frameDoc.querySelectorAll('.triangle-svg circle');
                
                if (triangleSvg && triangleCircles.length >= 4) {
                    updateTestItem('test-triangle', 'pass', `Triangle SVG with ${triangleCircles.length} strategy nodes found`);
                } else {
                    updateTestItem('test-triangle', 'fail', 'Triangle visualization incomplete');
                }
                
                // Test 3: Week Navigator
                const weekCards = frameDoc.querySelectorAll('.week-card');
                const weekButtons = frameDoc.querySelectorAll('.week-btn');
                
                if (weekCards.length === 7 && weekButtons.length === 7) {
                    updateTestItem('test-weeks', 'pass', '7 week cards with buttons found');
                } else {
                    updateTestItem('test-weeks', 'fail', `Only ${weekCards.length} week cards found`);
                }
                
                // Test 4: Role Cards
                const ceoCard = frameDoc.querySelector('.ceo-card');
                const cfoCard = frameDoc.querySelector('.cfo-card');
                const cooCard = frameDoc.querySelector('.coo-card');
                const cioCard = frameDoc.querySelector('.cio-card');
                
                if (ceoCard && cfoCard && cooCard && cioCard) {
                    updateTestItem('test-roles', 'pass', 'All 4 executive role cards present');
                } else {
                    updateTestItem('test-roles', 'fail', 'Missing role cards');
                }
                
                // Test 5: WAAROM/HOE/WAT Tabs
                const tabButtons = frameDoc.querySelectorAll('.tab-btn');
                const tabContents = frameDoc.querySelectorAll('.tab-content');
                
                if (tabButtons.length === 3 && tabContents.length === 3) {
                    updateTestItem('test-tabs', 'pass', 'WAAROM/HOE/WAT tabs functional');
                } else {
                    updateTestItem('test-tabs', 'fail', 'Tab system incomplete');
                }
                
                // Test 6: AI Prompts
                const promptCards = frameDoc.querySelectorAll('.prompt-card');
                const copyButtons = frameDoc.querySelectorAll('.copy-btn');
                
                if (promptCards.length > 0 && copyButtons.length > 0) {
                    updateTestItem('test-prompts', 'pass', `${promptCards.length} prompt templates with copy buttons`);
                } else {
                    updateTestItem('test-prompts', 'warning', 'AI prompt section needs content');
                }
                
                // Test 7: Project Timeline
                const timelineItems = frameDoc.querySelectorAll('.timeline-item');
                const timelineMarkers = frameDoc.querySelectorAll('.timeline-marker');
                
                if (timelineItems.length === 7 && timelineMarkers.length === 7) {
                    updateTestItem('test-timeline', 'pass', '7-week timeline with all markers');
                } else {
                    updateTestItem('test-timeline', 'fail', 'Timeline incomplete');
                }
                
                // Test 8: Countdown Timer
                const countdownDisplay = frameDoc.querySelector('.countdown-display');
                const countdownValues = frameDoc.querySelectorAll('.countdown-value');
                
                if (countdownDisplay && countdownValues.length === 4) {
                    updateTestItem('test-countdown', 'pass', 'Countdown timer with days/hours/minutes/seconds');
                } else {
                    updateTestItem('test-countdown', 'fail', 'Countdown timer not functioning');
                }
                
                // Test 9: Resources Section
                const resourceCards = frameDoc.querySelectorAll('.resource-card');
                const downloadButtons = frameDoc.querySelectorAll('.download-btn');
                
                if (resourceCards.length === 6 && downloadButtons.length === 6) {
                    updateTestItem('test-resources', 'pass', '6 resource templates available for download');
                } else {
                    updateTestItem('test-resources', 'warning', `Only ${resourceCards.length} resources found`);
                }
                
                // Test 10: Feedback Flow
                const flowDiagram = frameDoc.querySelector('.flow-diagram');
                const feedbackItems = frameDoc.querySelectorAll('.feedback-item');
                
                if (flowDiagram && feedbackItems.length === 4) {
                    updateTestItem('test-feedback', 'pass', 'Complete feedback flow with 4 stages');
                } else {
                    updateTestItem('test-feedback', 'warning', 'Feedback flow diagram incomplete');
                }
                
                // Update results display
                displayResults();
                
            } catch (error) {
                console.error('Test error:', error);
                document.getElementById('testResults').textContent = 'Error running tests: ' + error.message;
            }
        }

        function testInteractivity() {
            console.log('Testing interactive elements...');
            const frame = document.getElementById('previewFrame');
            const frameWindow = frame.contentWindow;
            
            // Test tab switching
            const tabBtn = frameWindow.document.querySelector('.tab-btn:nth-child(2)');
            if (tabBtn) {
                tabBtn.click();
                console.log('Tab switching tested');
            }
            
            // Test modal opening
            if (frameWindow.showWeekDetails) {
                frameWindow.showWeekDetails(1);
                console.log('Modal functionality tested');
            }
            
            alert('Interactivity tests completed. Check console for details.');
        }

        function testResponsive(size) {
            const frame = document.getElementById('previewFrame');
            const sizes = {
                mobile: '375px',
                tablet: '768px',
                desktop: '1280px'
            };
            
            frame.style.width = sizes[size];
            console.log(`Testing ${size} view at ${sizes[size]}`);
        }

        function displayResults() {
            const output = `Student Portal Test Results - ${new Date().toLocaleString()}
===========================================
Summary:
  Total Tests: ${testResults.summary.total}
  ‚úÖ Passed: ${testResults.summary.passed}
  ‚ùå Failed: ${testResults.summary.failed}
  ‚ö†Ô∏è Warnings: ${testResults.summary.warnings}

Individual Tests:
${Object.entries(testResults.tests).map(([id, result]) => 
  `  ${id}: ${result.status.toUpperCase()}${result.message ? '\n    ‚Üí ' + result.message : ''}`
).join('\n')}

Overall Status: ${testResults.summary.failed === 0 ? '‚úÖ ALL TESTS PASSING' : '‚ùå SOME TESTS FAILING'}`;
            
            document.getElementById('testResults').textContent = output;
        }

        function exportResults() {
            const dataStr = JSON.stringify(testResults, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'test-results-studenten.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Auto-run tests on load
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1500);
        });
    </script>
</body>
</html>